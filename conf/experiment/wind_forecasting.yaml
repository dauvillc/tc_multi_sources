# @package _global_
defaults:
  - override /paths: jz
  - override /dataloader: jz
  - override /sources: pmw_era5_bt
  - override /lightning_module: deterministic
  - override /lr_scheduler: cosine_warmup_100epochs
  - override /metrics: default_fm
  - override /data_augmentation: random_cropping

wandb:
  name: wind_forecasting
  group: wind_forecasting

dataset:
  train:
    dt_max: 24
    min_ref_time_delta: 24
    min_available_sources: 2
    # Minimum number of sources to be available for each source type:
    # we only keep samples with at least one source of each type.
    source_types_min_avail:
      era5: 1
      pmw: 1
      storm_metadata: 1
    # Max number of observations for each source of each type:
    source_types_max_avail:
      era5: 1
      storm_metadata: 1
      pmw: 1
    select_most_recent: true
    # Parameters to perform a forecasting task specifically.
    # Those are automatically propagated to the val and test datasets.
    forecasting_lead_time: 24
    forecasting_sources: tc_primed_storm_metadata
    # Parameter to mask the spatial coordinates of the forecast source
    # (Since we don't know the future location of the storm)
    mask_spatial_coords: ['tc_primed_storm_metadata']
  val:
    select_most_recent: true
  test:
    select_most_recent: true
  
lightning_module:
  forecasting_mode: true

trainer:
  strategy: ddp_find_unused_parameters_true