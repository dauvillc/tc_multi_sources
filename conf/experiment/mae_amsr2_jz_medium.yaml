# @package _global_
defaults:
  - override /paths: jz
  - override /sources: amsr2_5freqs
  - override /lightning_module: mae
  - override /trainer: 4gpus
  - override /lr_scheduler: cosine_warmup_300epochs.yaml

wandb:
  name: amsr2_vit_medium

dataloader:
  batch_size: 16

lightning_module:
  patch_size: 16
  coords_dim: 1024
  pixels_dim: 1024

model:
  encoder:
    n_blocks: 10
    layers:
      self_attention:
        layer_class:
          _target_: hydra.utils.get_class
          path: multi_sources.models.attention.PixelsCoordinatesAttention
        inner_dim: 1024
        num_heads: 8
      ff2:
        layer_class:
          _target_: hydra.utils.get_class
          path: multi_sources.models.small_layers.FeedForward
        inner_dim: 1024
  decoder:
    n_blocks: 8
    layers:
      self_attention:
        layer_class:
          _target_: hydra.utils.get_class
          path: multi_sources.models.attention.PixelsCoordinatesAttention
        inner_dim: 1024
        num_heads: 8
      ff2:
        layer_class:
          _target_: hydra.utils.get_class
          path: multi_sources.models.small_layers.FeedForward
        inner_dim: 1024
